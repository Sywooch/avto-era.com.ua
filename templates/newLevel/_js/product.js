var productPhotoCZoom=window.productPhotoCZoom!=undefined,productPhotoDrop=window.productPhotoDrop!=undefined;function tovarChangeVariant(a){a=a==undefined?body:a;a.find("#variantSwitcher").on("change",function(){var f=parseInt($(this).attr("value")),b=$(this).closest(genObj.parentBtnBuy),l=b.find(genObj.prefV+f+" "+genObj.infoBut),m=l.attr("data-id"),d=l.attr("data-vname"),g=l.attr("data-number"),h=l.attr("data-price"),i=l.attr("data-addPrice"),c=l.attr("data-origPrice"),k=l.attr("data-largeImage"),e=l.attr("data-mainImage"),j=l.attr("data-maxcount");if(e.search(/nophoto/)==-1){$(genObj.photoProduct).add($(genObj.mainThumb)).attr("href",k);$(genObj.imgVP).attr({src:e,alt:d});$(".left-product .items-thumbs > li").removeClass("active").filter(":eq(0)").addClass("active")}if(c!=""){b.find(genObj.priceOrigVariant).html(c)}b.find(genObj.priceVariant).html(h);b.find(genObj.priceAddPrice).html(i);existsVnumber(g,b);existsVnames(d,b);condProduct(j,b,l);b.find(genObj.selVariant).hide();b.find(genObj.prefV+m).show();$(".mousetrap").remove();$(".cloud-zoom, .cloud-zoom-gallery").CloudZoom()})}function resizePhoto(d,e,i){var g=$(hrefOptions.placeHref).parent(),b=g.find("img");g.css("height","");b.css({width:b.actual("width"),height:b.actual("height")});var f=d.is(":visible")?true:false;hD=f?d.height():d.actual("height");var h=hD>wnd.height()?wnd.height():hD,a=0;if(e!=undefined){e()}$(hrefOptions.header).add($(hrefOptions.footer)).add($(hrefOptions.gallery)).each(function(){a+=f?$(this).outerHeight():$(this).actual("outerHeight")});$(hrefOptions.header).add($(hrefOptions.footer)).add($(hrefOptions.gallery));mayHC=h-a;g.css({height:mayHC-(g.outerHeight()-g.height())});b.css({width:"",height:""});if(i!=undefined){i()}$.drop("dropCenter")(d)}function changePhoto(a,b,d){hrefOptions.curHref=d;var c=a[1];b.parent().addClass("p_r");b.after('<div class="preloader"></div>');$('<img src="'+d+'">').load(function(){$(hrefOptions.placeHref).find("img").remove();b.nextAll(".preloader").remove();b.after($(this).css("visibility","visible").hide().fadeIn());var e=c.find(".content-carousel");$.drop("limitSize")(c);resizePhoto(c,function(){e.parent().myCarousel($.extend({},carousel,{adding:{start:$.inArray(hrefOptions.curHref,hrefOptions.thumbs)}}));$.drop("dropCenter")(c)})})}function beforeShowHref(a,f,e,t,c){var d=arguments,h=hrefOptions.cycle;var i=$.extend({},c,hrefOptions,a.closest(genObj.parentBtnBuy).find(genObj.infoBut).data());frame=$("#photo");frame.html(_.template($("#framePhotoProduct").html(),i));tovarChangeCount(frame);btnbuyInitialize(frame);processBtnBuyCount(frame);var m=$(hrefOptions.next),k=$(hrefOptions.prev),u=$(hrefOptions.placeHref).find("img");hrefOptions.curHref=u.attr("src");var o=$(hrefOptions.placeHref).find(".helper");function b(v){if(!h){if(v==0){k.attr("disabled","disabled")}if(v==r-1){m.attr("disabled","disabled")}}}function g(v){j.removeClass("active");if(v.is(k)){m.removeAttr("disabled")}else{k.removeAttr("disabled")}s=($.inArray(hrefOptions.curHref,hrefOptions.thumbs));if(v.is(k)){if(h){if(s!=0){s=s-1}else{s=r-1}}else{if(s!=0){s=s-1}if(s==0){k.attr("disabled","disabled")}}}else{if(h){if(s!=r-1){s=s+1}else{s=0}}else{if(s!=r-1){s=s+1}if(s==r-1){m.attr("disabled","disabled")}}}l.eq(s).parent().addClass("active");changePhoto(d,o,hrefOptions.thumbs[s])}var p=f.find(".content-carousel");if($.existsN(p.find(".items-thumbs").children())){p.closest(".horizontal-carousel").show();var j=p.find(".items-thumbs > li").removeClass("active"),r=j.length,l=j.find("a");hrefOptions.thumbs=new Array();l.each(function(){hrefOptions.thumbs.push($(this).attr("href"))});var n=k.add(m).removeAttr("disabled").fadeIn(),s=($.inArray(u.attr("src"),hrefOptions.thumbs));j.eq(s).addClass("active");var q=j.parent();if($.existsN(q.parent(".jcarousel-clip"))){q.unwrap()}l.off("click").on("click",function(x){n.removeAttr("disabled");j.removeClass("active");$(this).parent().addClass("active");var v=$(this).attr("href"),w=($.inArray(v,hrefOptions.thumbs));x.preventDefault();changePhoto(d,o,v);b(w)});n.off("click").on("click",function(v){g($(this))});b(s)}else{p.closest(".horizontal-carousel").hide()}wnd.unbind("resize.photo").bind("resize.photo",function(){resizePhoto(f)})}function afterClosedPhoto(b,a){a.find(".addingphoto").remove()}function onComplete(d,c,a,e,b){c.find("[data-drop]").drop(optionsDrop);var f=c.find(".content-carousel");c.find(".drop-content-photo img").css("visibility","visible");$.drop("limitSize")(c);resizePhoto(c,function(){f.parent().myCarousel($.extend({},carousel,{adding:{start:$.inArray(hrefOptions.curHref,hrefOptions.thumbs)},after:function(g){g.find("ul").css("visibility","visible")}}))})}var hrefOptions={next:"#photo .drop-content-photo .next",prev:"#photo .drop-content-photo .prev",placeHref:"#photo .drop-content-photo .inside-padd",header:"#photo .drop-header",footer:"#photo .drop-footer",gallery:"#photo .frame-fancy-gallery",cycle:false,footerContent:".frame-prices-buy",galleryContent:".items-thumbs"};var optionsPhoto={effectOn:"fadeIn",drop:"#photo",size:false,after:"onComplete",before:"beforeShowHref",closed:"afterClosedPhoto"};function initPhoto(){if(productPhotoCZoom){function a(){$(genObj.photoProduct).find("img").each(function(){var c=$(this),b=Math.ceil((c.parent().outerHeight()-c.height())/2),d=Math.ceil((c.parent().outerWidth()-c.width())/2);$("#forCloudZomm").empty().append(".cloud-zoom-lens{margin:"+b+"px 0 0 "+d+"px;}.mousetrap{top:"+b+"px !important;left:"+d+"px !important;}")});$(".left-product").off("mouseover",".mousetrap").on("mouseover",".mousetrap",function(){var b=$(".cloud-zoom-lens");if(b.width()>$(genObj.photoProduct).width()){$(this).remove();b.remove();$("#xBlock").empty()}})}}if(productPhotoCZoom){$(".cloud-zoom, .cloud-zoom-gallery").CloudZoom();body.append('<style id="forCloudZomm"></style>');a();$(genObj.photoProduct).find("img").load(function(){a()})}$(".item-product .items-thumbs > li > a").on("click.thumb",function(d){d.preventDefault();var c=$(this),b=c.attr("href");c.parent().siblings().removeClass("active").end().addClass("active");$(genObj.photoProduct).attr("href",b).find("img").attr("src",b)});if(productPhotoDrop){$(genObj.photoProduct).on("click",function(){photo=$(this);photo.data($.extend({frame:photo.closest(genObj.parentBtnBuy),mainPhoto:photo.attr("href"),title:photo.attr("title")},optionsPhoto)).drop(optionsDrop).trigger("click.drop").off("click.drop")})}if(productPhotoDrop&&productPhotoCZoom){$(".left-product").on("click.mousetrap",".mousetrap",function(){var c=$(this),b=c.prev();c.data($.extend({frame:b.closest(genObj.parentBtnBuy),mainPhoto:b.attr("href"),title:b.attr("title")},optionsPhoto)).drop(optionsDrop).trigger("click.drop")})}}function initPhotoTrEv(){}$(document).on("scriptDefer",function(){initPhoto();cuselInit(body,"#variantSwitcher");tovarChangeVariant()});